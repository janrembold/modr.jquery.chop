/*! modr.jquery.chop | @version v0.1.0 | @license MIT */
!function(o){"use strict";function e(o,e){var t=this;t.root=o,t.options=e}var t={plugin:"chop",module:"accordion",defaults:{autoClose:!0,duration:300,scroll:!0,scrollDuration:500,onScrollAddTopOffset:function(){return 0}}},i={init:function(){var o=this,e=o.root;e.wrapEvents("init.accordion.chop",function(){e.$element.addClass("chop--accordion"),o.$items=e.$element.find(".chop__item"),o.close(),o.open(e.currentItem,0),e.$element.removeClass("chop--loading"),o.initListeners()})},initListeners:function(){var e=this,t=e.root;t.$element.on("click.item.accordion.chop",".chop__header",function(i){if(i.preventDefault(),!e.isActive){e.isActive=!0;var n=o(this).closest(".chop__item"),c=e.$items.index(n),s=t.options.accordion.duration;e.open(c,s),setTimeout(function(){e.isActive=!1},s)}})},open:function(e,t){var i=this,n=i.root,c=i.$items.eq(e),s=i.predictHeaderTop(e);if("undefined"!=typeof t&&o.isNumeric(t)||(t=n.options.accordion.duration),i.close(e,t),!c.hasClass("chop__item--active")){var r=c.find(".chop__content");n.wrapEvents("open.accordion.chop",function(){c.addClass("chop__item--opening"),r.slideDown(t,function(){c.addClass("chop__item--active").removeClass("chop__item--opening"),o(this).css("display","")}),i.animateScroll(s,n.options.accordion.scrollDuration)},c),n.currentItem=e}},close:function(e,t){var i=this,n=i.root;"undefined"!=typeof t&&o.isNumeric(t)||(t=n.options.accordion.duration),n.$element.find(".chop__item--active").each(function(){var c=o(this),s=c.find(".chop__content");return n.options.accordion.autoClose||c.get(0)===i.$items.eq(e).get(0)?void n.wrapEvents("close.accordion.chop",function(){c.addClass("chop__item--closing"),s.slideUp(t,function(){c.removeClass("chop__item--active chop__item--closing"),o(this).css("display","")})},c):!0})},predictHeaderTop:function(e){var t=this,i=t.root;if(!i.options.accordion.scroll||!i.options.accordion.autoClose||t.$items.eq(e).hasClass("chop__item--active"))return-1;var n=t.$items.eq(e),c=n.prevAll(".chop__item--active");if(c.length>0){var s=0,r=n.offset().top;return c.each(function(){var e=o(this).find(".chop__content");s+=e.innerHeight()}),r-s+i.options.accordion.onScrollAddTopOffset()}return-1},animateScroll:function(e,t){0>e||o("html, body").animate({scrollTop:e},t)},destroy:function(){var o=this,e=o.root;e.$element.addClass("chop--loading"),e.$element.removeClass("chop--accordion"),o.$items.removeClass("chop__item--active"),e.$element.off("click.item.accordion.chop"),delete o.isActive,delete o.$items}};o.extend(e.prototype,i),modr.registerModule(t,e)}(jQuery);