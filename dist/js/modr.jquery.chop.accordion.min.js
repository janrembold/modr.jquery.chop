/*! modr.jquery.chop | @version v0.1.0 | @license MIT */
!function(e){"use strict";function o(e,o){var t=this;t.root=e,t.options=o}var t={plugin:"chop",module:"accordion",defaults:{autoClose:!0,duration:300,scroll:!0,scrollDuration:500,onScrollAddTopOffset:function(){return 0}}},i={init:function(){var o=this,t=o.root;t.wrapEvents("init.accordion.chop",function(){t.$element.addClass("chop--accordion"),o.$items=t.$element.find(".chop__item"),e.isNumeric(t.currentItem)&&(o.close(),o.open(t.currentItem,0)),t.$element.removeClass("chop--loading"),o.initListeners()})},initListeners:function(){var o=this,t=o.root;t.$element.on("click.item.accordion.chop",".chop__header",function(t){if(t.preventDefault(),!o.isActive){o.isActive=!0;var i=e(this).closest(".chop__item"),n=o.$items.index(i),c=o.options.duration;o.open(n,c),setTimeout(function(){o.isActive=!1},c)}})},open:function(o,t){var i=this,n=i.root,c=i.$items.eq(o),s=i.predictHeaderTop(o);if("undefined"!=typeof t&&e.isNumeric(t)||(t=i.options.duration),i.close(o,t),!c.hasClass("chop__item--active")){var r=c.find(".chop__content");n.wrapEvents("open.accordion.chop",function(){c.addClass("chop__item--opening"),r.slideDown(t,function(){c.addClass("chop__item--active").removeClass("chop__item--opening"),e(this).css("display","")}),i.animateScroll(s,i.options.scrollDuration)},c),n.currentItem=o}},close:function(o,t){var i=this,n=i.root;"undefined"!=typeof t&&e.isNumeric(t)||(t=i.options.duration),n.$element.find(".chop__item--active").each(function(){var c=e(this),s=c.find(".chop__content");return i.options.autoClose||c.get(0)===i.$items.eq(o).get(0)?void n.wrapEvents("close.accordion.chop",function(){c.addClass("chop__item--closing"),s.slideUp(t,function(){c.removeClass("chop__item--active chop__item--closing"),e(this).css("display","")})},c):!0})},predictHeaderTop:function(o){var t=this;if(!t.options.scroll||!t.options.autoClose||t.$items.eq(o).hasClass("chop__item--active"))return-1;var i=t.$items.eq(o),n=i.prevAll(".chop__item--active");if(n.length>0){var c=0,s=i.offset().top;return n.each(function(){var o=e(this).find(".chop__content");c+=o.innerHeight()}),s-c+t.options.onScrollAddTopOffset()}return-1},animateScroll:function(o,t){0>o&&(o=0),e("html, body").animate({scrollTop:o},t)},destroy:function(){var e=this,o=e.root;o.$element.addClass("chop--loading"),o.$element.removeClass("chop--accordion"),e.$items.removeClass("chop__item--active"),o.$element.off("click.item.accordion.chop"),delete e.isActive,delete e.$items}};e.extend(o.prototype,i),modr.registerModule(t,o)}(jQuery);