/*! modr.jquery.chop | @version v0.3.2 | @license MIT */
!function(e,t){"use strict";var o={plugin:"chop",module:"accordion",defaults:{autoClose:!0,duration:300,scroll:!0,scrollDuration:500,onScrollAddTopOffset:function(){return 0},predictHeaderTop:null},dependencies:{helper:["events"]}};modr.registerModule(o,{prepare:function(){var e=this;e.$element.data("auto-close")!==t&&(e.options.autoClose=e.$element.data("auto-close")),e.$element.data("scroll")!==t&&(e.options.scroll=e.$element.data("scroll")),e.$element.data("duration")!==t&&(e.options.duration=e.$element.data("duration")),e.$element.data("scroll-duration")!==t&&(e.options.scrollDuration=e.$element.data("scroll-duration"))},init:function(t){var o=this;o.eventHelper=o.root.modules.helper.events,o.eventHelper.wrapEvents("init.accordion.chop",function(){o.$element.addClass("chop--accordion"),o.$items=o.$element.find(".chop__item");var i={};if(o.$element.trigger("open.items.chop",[i]),"undefined"!=typeof i.openItems&&(t=i.openItems),"undefined"!=typeof t){e.isArray(t)||(t=[t]);for(var n=0,s=t.length;s>n;++n)o.open(t[n],0)}o.initListeners()}),o.$element.removeClass("chop--loading")},initListeners:function(){var t=this;t.root;t.$element.on("click.item.accordion.chop",".chop__header",function(o){if(o.preventDefault(),!t.isActive){t.isActive=!0;var i=e(this).closest(".chop__item"),n=t.$items.index(i),s=t.options.duration;t.open(n,s),setTimeout(function(){t.isActive=!1},s)}})},open:function(t,o){var i=this,n=i.root,s=i.$items.eq(t),c=i.predictHeaderTop(t);if("undefined"!=typeof o&&e.isNumeric(o)||(o=i.options.duration),i.close(t,o),!s.hasClass("chop__item--active")){var r=s.find(".chop__content");i.eventHelper.wrapEvents("open.item.chop",function(){s.addClass("chop__item--opening"),r.slideDown(o,function(){s.addClass("chop__item--active").removeClass("chop__item--opening"),e(this).css("display","")}),i.animateScroll(c,o)},s),n.currentItem=t}},close:function(t,o){var i=this;"undefined"!=typeof o&&e.isNumeric(o)||(o=i.options.duration),i.$element.find(".chop__item--active").each(function(){var n=e(this),s=n.find(".chop__content");return i.options.autoClose||n.get(0)===i.$items.eq(t).get(0)?void i.eventHelper.wrapEvents("close.item.chop",function(){n.addClass("chop__item--closing"),s.slideUp(o,function(){n.removeClass("chop__item--active chop__item--closing"),e(this).css("display","")})},n):!0})},predictHeaderTop:function(t){var o=this;if(e.isFunction(o.options.predictHeaderTop))return o.options.predictHeaderTop();if(!o.options.scroll||!o.options.autoClose||o.$items.eq(t).hasClass("chop__item--active"))return-1;var i=o.$items.eq(t),n=i.prevAll(".chop__item--active");if(n.length>0){var s=0,c=i.offset().top;n.each(function(){var t=e(this).find(".chop__content");s+=t.innerHeight()});var r=c-s+o.options.onScrollAddTopOffset();if(r<window.pageYOffset)return r}return-1},animateScroll:function(t,o){var i=this;!i.options.scroll||0>t||e("html, body").animate({scrollTop:t},o)},destroy:function(){var e=this;e.$element.addClass("chop--loading"),e.$element.removeClass("chop--accordion"),e.$items.removeClass("chop__item--active"),e.$element.off("click.item.accordion.chop"),delete e.isActive,delete e.$items,delete e.eventHelper}})}(jQuery);